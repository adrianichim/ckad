  - Delploy and start the echoserver application
  - Scale the application
  - Use Services to load bbalance between multiple Pods of the app
  - Leverage KKubernetes resilience to maintain the declared state even with failures
  - Rollout a new version oof the application

##  NOTE: I am still unable to access the container contents
## from the "Internet" - fro the external IP of the VM (node)

```
{ clear && \
  echo -e "\n=== Kubernetes Status ===\n" && \
  kubectl get --raw '/healthz?verbose' && \
  kubectl version --short && \
  kubectl get nodes && \
  kubectl cluster-info;
} | grep -z 'Ready\| ok\|passed\|running'

helm version --short

kubectl apply -f echoserver.yaml

kubectl get deployments,pods
# 
#  We could use a CLI command to create the Pod:
#
#  kubectl run hello --image=k8s.gkr.io/echoserver:1.9  --port=8080
#
#  but this only creates a Pod
#

less echoserver.yaml | tee

# the deployment is a ReplicaSet of a Pod !!!
#  and the pod consists on only one container
#
#  Now we will patch the deployment (long live jq the JSON Patch)
#  to publish the service at the fixed port 31001
#

kubectl patch service hello --type='json' --patch='[{"op": "replace", "path": "/spec/ports/0/nodePort", "value":31001}]'

kubectl get service helllo

kubectl describe service hello

#
#  will scale the service and use round-robin load balancing
#

# in a different terminal:

while true; do curl -s https://7e7a9e3a1a8d4f84a1f5f610e642fad0-2886794245-31001-kira01.environments.katacoda.com/ -w 'Time: %{time_total}' | grep -E 'Hostname|Time' | xargs; done

#  Scale environment
kubectl scale deployment hello --replicas=3
kubectl get pods -l run=hello
## again

kubectl describe service Hhello | grep "Endpoints"

kubectl scale deployment hello --replicas=0

watch kubectl get pods

kubectl scale deployment hello --replicas=1

kubectl get deployments,pods

#  get the metrics for the new pod:

kubectl get pods -l run=hello

# scale the pods:

kubectl scale deployment hello --replicas=3

kubectl get pods --selector=run=hello








